{% extends "base.html" %}

{% block window_path %}
    {# Single Section: Shows directory name #}
    ~/{{ section.path | trim_start_matches(pat="/") | trim_end_matches(pat="/") }}
{% endblock %}

{% block prompt_path %}
    ~/{{ section.path | trim_start_matches(pat="/") }}
{% endblock %}

{% block prompt_cmd %}
    {% if section.pages %}
        ls -la
    {% else %}
        cat index.md
    {% endif %}
{% endblock %}

{% block content %}
    {% if section.pages %}
        <!-- LIST VIEW (ls -la style) -->
        <div class="ls-grid">
            <div class="ls-total">total {{ section.pages | length }}</div>

            {% for page in section.pages %}
                <!-- Permissions -->
                <span class="ls-perms">-rw-r--r--</span>
                
                <!-- User -->
                <span class="ls-user">{{ config.extra.user | default(value="user") }}</span>
                
                <!-- Size / Reading Time -->
                <span class="ls-size">
                    {% if page.reading_time %}{{ page.reading_time }}m{% else %}4.0K{% endif %}
                </span>
                
                <!-- Date (With Fallback for pages without date) -->
                <span class="ls-date">
                    {% if page.date %}
                        {{ page.date }}
                    {% endif %}
                </span>
                {% if page.extra.repo %}
                    <a href="{{ page.extra.repo }}" target="_blank" class="ls-name" style="color: var(--text-accent-2);">
                        {{ page.title }} <span style="color: var(--text-dim); font-weight: normal; opacity: 0.8;">-> {{ page.extra.repo }}</span>
                    </a>
                {% else %}
                    <a href="{{ page.permalink }}" class="ls-name">
                        {{ page.title }}
                    </a>
                {% endif %}

                {% if page.description %}
                    <div style="grid-column: 1 / -1; color: var(--text-dim); font-size: 0.85em; margin-top: -0.25rem; padding-left: 1rem; opacity: 0.8;">
                        # {{ page.description }}
                    </div>
                {% endif %}
            {% endfor %}
        </div>

    {% else %}
        <!-- SINGLE PAGE VIEW (Render the _index.md content) -->
        <article class="post-layout">
            <header class="post-header">
                <h1 class="post-title">{{ section.title }}</h1>
            </header>

            <div class="post-content">
                {{ section.content | safe }}
            </div>
        </article>
    {% endif %}
{% endblock content %}
